import{p as ue,ax as se,ay as ye,q as ie,E as de,az as ce,aA as xe,c as $,J as me,aB as ve,aC as j,L as t,M as z,aD as be,aE as he,G as V,s as ke,d as we,o as Ce,w as N,b as Pe,aF as Fe,aG as Se,O as L,aa as te,aH as Ae,aI as Re,aJ as $e,aK as Ie,Q,aL as Me,a as Be,a0 as De,R as Ue,ad as Te,aM as qe,U as Ne,Y as le,W as Ee,X as s,aw as ze,ai as S,af as _,ag as R,ah as He,au as W,V as Ge,$ as Oe,aj as _e,Z as d,aN as Le,at as je,aq as Je,as as Ke,aO as Qe,aP as We,am as Xe,ac as Ye}from"./index-LUeNgdw9.js";import{c as Ze,a as X,b as ea,d as aa,u as ta,e as E,V as la}from"./index.esm-CuvOTSbQ.js";import{a as oa,V as oe,b as re}from"./route-block-D3zf8sPq.js";import{V as ra}from"./VDivider-CsGpuCD4.js";import{m as na,a as ne,V as ua,b as sa}from"./VDataTable-BHfF7pj9.js";import{V as ia}from"./VToolbar-DxxHxAJU.js";import{V as da}from"./VContainer-BbQ6pW1k.js";import"./VPagination-By_QClsd.js";import"./VList-B4n08LuB.js";import"./VMenu-LML5Ze4H.js";const ca=ue({...se(),...ye(na(),["inline"])},"VCheckbox"),ma=ie()({name:"VCheckbox",inheritAttrs:!1,props:ca(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,n){let{attrs:y,slots:p}=n;const i=de(e,"modelValue"),{isFocused:m,focus:x,blur:I}=ce(e),U=xe(),c=$(()=>e.id||`checkbox-${U}`);return me(()=>{const[M,B]=ve(y),D=j.filterProps(e),b=ne.filterProps(e);return t(j,z({class:["v-checkbox",e.class]},M,D,{modelValue:i.value,"onUpdate:modelValue":k=>i.value=k,id:c.value,focused:m.value,style:e.style}),{...p,default:k=>{let{id:f,messagesId:w,isDisabled:g,isReadonly:C,isValid:P}=k;return t(ne,z(b,{id:f.value,"aria-describedby":w.value,disabled:g.value,readonly:C.value},B,{error:P.value===!1,modelValue:i.value,"onUpdate:modelValue":T=>i.value=T,onFocus:x,onBlur:I}),p)}})}),{}}}),va=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...se(),...be()},"VTextarea"),fa=ie()({name:"VTextarea",directives:{Intersect:he},inheritAttrs:!1,props:va(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,n){let{attrs:y,emit:p,slots:i}=n;const m=de(e,"modelValue"),{isFocused:x,focus:I,blur:U}=ce(e),c=$(()=>typeof e.counterValue=="function"?e.counterValue(m.value):(m.value||"").toString().length),M=$(()=>{if(y.maxlength)return y.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function B(o,a){var u,h;!e.autofocus||!o||(h=(u=a[0].target)==null?void 0:u.focus)==null||h.call(u)}const D=V(),b=V(),k=ke(""),f=V(),w=$(()=>e.persistentPlaceholder||x.value||e.active);function g(){var o;f.value!==document.activeElement&&((o=f.value)==null||o.focus()),x.value||I()}function C(o){g(),p("click:control",o)}function P(o){p("mousedown:control",o)}function T(o){o.stopPropagation(),g(),Q(()=>{m.value="",Me(e["onClick:clear"],o)})}function H(o){var u;const a=o.target;if(m.value=a.value,(u=e.modelModifiers)!=null&&u.trim){const h=[a.selectionStart,a.selectionEnd];Q(()=>{a.selectionStart=h[0],a.selectionEnd=h[1]})}}const v=V(),A=V(+e.rows),q=$(()=>["plain","underlined"].includes(e.variant));we(()=>{e.autoGrow||(A.value=+e.rows)});function l(){e.autoGrow&&Q(()=>{if(!v.value||!b.value)return;const o=getComputedStyle(v.value),a=getComputedStyle(b.value.$el),u=parseFloat(o.getPropertyValue("--v-field-padding-top"))+parseFloat(o.getPropertyValue("--v-input-padding-top"))+parseFloat(o.getPropertyValue("--v-field-padding-bottom")),h=v.value.scrollHeight,G=parseFloat(o.lineHeight),J=Math.max(parseFloat(e.rows)*G+u,parseFloat(a.getPropertyValue("--v-input-control-height"))),K=parseFloat(e.maxRows)*G+u||1/0,F=De(h??0,J,K);A.value=Math.floor((F-u)/G),k.value=Be(F)})}Ce(l),N(m,l),N(()=>e.rows,l),N(()=>e.maxRows,l),N(()=>e.density,l);let r;return N(v,o=>{o?(r=new ResizeObserver(l),r.observe(v.value)):r==null||r.disconnect()}),Pe(()=>{r==null||r.disconnect()}),me(()=>{const o=!!(i.counter||e.counter||e.counterValue),a=!!(o||i.details),[u,h]=ve(y),{modelValue:G,...J}=j.filterProps(e),K=Fe(e);return t(j,z({ref:D,modelValue:m.value,"onUpdate:modelValue":F=>m.value=F,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":q.value},e.class],style:e.style},u,J,{centerAffix:A.value===1&&!q.value,focused:x.value}),{...i,default:F=>{let{id:O,isDisabled:Y,isDirty:Z,isReadonly:fe,isValid:pe}=F;return t(Se,z({ref:b,style:{"--v-textarea-control-height":k.value},onClick:C,onMousedown:P,"onClick:clear":T,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},K,{id:O.value,active:w.value||Z.value,centerAffix:A.value===1&&!q.value,dirty:Z.value||e.dirty,disabled:Y.value,focused:x.value,error:pe.value===!1}),{...i,default:ge=>{let{props:{class:ee,...ae}}=ge;return t(L,null,[e.prefix&&t("span",{class:"v-text-field__prefix"},[e.prefix]),te(t("textarea",z({ref:f,class:ee,value:m.value,onInput:H,autofocus:e.autofocus,readonly:fe.value,disabled:Y.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:g,onBlur:U},ae,h),null),[[Ae("intersect"),{handler:B},null,{once:!0}]]),e.autoGrow&&te(t("textarea",{class:[ee,"v-textarea__sizer"],id:`${ae.id}-sizer`,"onUpdate:modelValue":Ve=>m.value=Ve,ref:v,readonly:!0,"aria-hidden":"true"},null),[[Re,m.value]]),e.suffix&&t("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:a?F=>{var O;return t(L,null,[(O=i.details)==null?void 0:O.call(i,F),o&&t(L,null,[t("span",null,null),t($e,{active:e.persistentCounter||x.value,value:c.value,max:M.value,disabled:e.disabled},i.counter)])])}:void 0})}),Ie({},D,b,f)}}),pa={class:"text-center"},ga={__name:"products",setup(e){const{t:n}=Ue(),{apiAuth:y}=Xe(),p=Te(),i=qe([]),m=V(""),x=$(()=>[{title:"ID",key:"_id",sortable:!0},{title:n("product.image"),key:"image",sortable:!1},{title:n("product.name"),key:"name",sortable:!0},{title:n("product.price"),key:"price",sortable:!0},{title:n("product.category"),key:"category",sortable:!0},{title:n("product.sell"),key:"sell",sortable:!0},{title:n("product.createdAt"),key:"createdAt",sortable:!0},{title:n("product.updatedAt"),key:"updatedAt",sortable:!0},{title:n("adminProduct.edit"),key:"edit",sortable:!1}]),I=async()=>{var l,r;try{const{data:o}=await y.get("/product/all");i.push(...o.result)}catch(o){console.log(o),p({text:n("api."+(((r=(l=o==null?void 0:o.response)==null?void 0:l.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};I();const U=Ze({name:X().required(n("api.productNameRequired")),price:ea().typeError(n("api.productPriceError")).required(n("api.productPriceRequired")).min(0,n("api.productPriceTooSmall")),description:X().required(n("api.productDescriptionRequired")),category:X().required(n("api.productCategoryRequired")).oneOf(["food","drink","music","phone"],n("api.productCategoryInvalid")),sell:aa().required(n("api.productSellRequired"))}),c=V({open:!1,id:""}),M=l=>{l&&(c.value.id=l._id,f.value.value=l.name,w.value.value=l.price,g.value.value=l.description,C.value.value=l.category,P.value.value=l.sell),c.value.open=!0},B=()=>{k(),c.value.id="",c.value.open=!1,H.value.deleteFileRecord()},{handleSubmit:D,isSubmitting:b,resetForm:k}=ta({validationSchema:U,initialValues:{name:"",price:0,description:"",category:"",sell:!1}}),f=E("name"),w=E("price"),g=E("description"),C=E("category"),P=E("sell"),T=$(()=>[{text:n("productCategory.food"),value:"food"},{text:n("productCategory.drink"),value:"drink"},{text:n("productCategory.music"),value:"music"},{text:n("productCategory.phone"),value:"phone"}]),H=V(null),v=V([]),A=V([]),q=D(async l=>{var r,o,a;if(!((r=v.value[0])!=null&&r.error)){if(c.value.id.length===0&&v.value.length===0){p({text:n("api.productImageRequired"),snackbarProps:{color:"red"}});return}try{const u=new FormData;u.append("name",l.name),u.append("price",l.price),u.append("description",l.description),u.append("category",l.category),u.append("sell",l.sell),v.value.length>0&&u.append("image",v.value[0].file),c.value.id.length>0?await y.patch("/product/"+c.value.id,u):await y.post("/product",u),i.splice(0,i.length),I(),p({text:n(c.value.id.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),B()}catch(u){console.log(u),p({text:n("api."+(((a=(o=u==null?void 0:u.response)==null?void 0:o.data)==null?void 0:a.message)||"unknownError")),snackbarProps:{color:"red"}})}}});return(l,r)=>{const o=Ne("VueFileAgent");return le(),Ee(L,null,[t(da,null,{default:s(()=>[t(oa,null,{default:s(()=>[t(oe,{cols:"12"},{default:s(()=>[ze("h1",pa,S(l.$t("nav.adminProducts")),1)]),_:1}),t(ra),t(oe,{cols:"12"},{default:s(()=>[t(ua,{items:i,headers:x.value,search:m.value},{top:s(()=>[t(ia,null,{default:s(()=>[t(_,{onClick:r[0]||(r[0]=a=>M(null))},{default:s(()=>[R(S(l.$t("adminProduct.new")),1)]),_:1}),t(He),t(W,{"prepend-inner-icon":"mdi-magnify",variant:"underline"})]),_:1})]),"item.image":s(({value:a})=>[t(Ge,{src:a,height:"50"},null,8,["src"])]),"item.sell":s(({value:a})=>[a?(le(),Oe(Ye,{key:0,icon:"mdi-check"})):_e("",!0)]),"item.createdAt":s(({value:a})=>[R(S(new Date(a).toLocaleString()),1)]),"item.updatedAt":s(({value:a})=>[R(S(new Date(a).toLocaleString()),1)]),"item.category":s(({value:a})=>[R(S(l.$t("productCategory."+a)),1)]),"item.edit":s(({item:a})=>[t(_,{icon:"mdi-pencil",variant:"text",onClick:u=>M(a)},null,8,["onClick"])]),_:2},1032,["items","headers","search"])]),_:1})]),_:1})]),_:1}),t(We,{modelValue:c.value.open,"onUpdate:modelValue":r[8]||(r[8]=a=>c.value.open=a),persistent:""},{default:s(()=>[t(la,{disabled:d(b),onSubmit:Le(d(q),["prevent"])},{default:s(()=>[t(je,null,{default:s(()=>[t(Je,null,{default:s(()=>[R(S(l.$t(c.value.id?"adminProduct.edit":"adminProduct.new")),1)]),_:1}),t(Ke,null,{default:s(()=>[t(W,{modelValue:d(f).value.value,"onUpdate:modelValue":r[1]||(r[1]=a=>d(f).value.value=a),label:l.$t("product.name"),"error-messages":d(f).errorMessage.value},null,8,["modelValue","label","error-messages"]),t(W,{modelValue:d(w).value.value,"onUpdate:modelValue":r[2]||(r[2]=a=>d(w).value.value=a),label:l.$t("product.price"),"error-messages":d(w).errorMessage.value,type:"number",min:"0"},null,8,["modelValue","label","error-messages"]),t(sa,{modelValue:d(C).value.value,"onUpdate:modelValue":r[3]||(r[3]=a=>d(C).value.value=a),"error-messages":d(C).errorMessage.value,items:T.value,label:l.$t("product.category"),"item-title":"text","item-value":"value"},null,8,["modelValue","error-messages","items","label"]),t(ma,{modelValue:d(P).value.value,"onUpdate:modelValue":r[4]||(r[4]=a=>d(P).value.value=a),label:l.$t("product.onSell"),"error-messages":d(P).errorMessage.value},null,8,["modelValue","label","error-messages"]),t(fa,{modelValue:d(g).value.value,"onUpdate:modelValue":r[5]||(r[5]=a=>d(g).value.value=a),label:l.$t("product.description"),"error-messages":d(g).errorMessage.value},null,8,["modelValue","label","error-messages"]),t(o,{ref_key:"fileAgent",ref:H,modelValue:v.value,"onUpdate:modelValue":r[6]||(r[6]=a=>v.value=a),"raw-model-value":A.value,"onUpdate:rawModelValue":r[7]||(r[7]=a=>A.value=a),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":l.$t("fileAgent.helpText"),"error-text":{type:l.$t("fileAgent.errorType"),size:l.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),t(Qe,null,{default:s(()=>[t(_,{onClick:B},{default:s(()=>[R(S(l.$t("adminProduct.cancel")),1)]),_:1}),t(_,{type:"submit",loading:d(b)},{default:s(()=>[R(S(l.$t("adminProduct.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof re=="function"&&re(ga);export{ga as default};
