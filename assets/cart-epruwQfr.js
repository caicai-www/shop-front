import{S as R,ae as S,ad as A,R as I,G as q,c as f,Y as c,$ as _,X as s,L as e,aw as V,ai as l,W as k,_ as z,O as v,af as u,ag as h,aR as D,V as E,aj as j,am as F}from"./index-LUeNgdw9.js";import{V as i,a as G,b as g}from"./route-block-D3zf8sPq.js";import{V as y}from"./VDivider-CsGpuCD4.js";import{V as O,a as P}from"./VList-B4n08LuB.js";import{V as T}from"./VContainer-BbQ6pW1k.js";const U={class:"text-center"},W={__name:"cart",setup(X){const{apiAuth:n}=F(),d=R(),C=S(),b=A(),{t:w}=I(),o=q([]),p=async()=>{try{const{data:a}=await n.get("/user/cart");o.value=a.result}catch(a){console.log(a)}};p();const x=f(()=>o.value.reduce((a,r)=>a+r.product.price*r.quantity,0)),B=f(()=>o.value.length>0&&o.value.every(a=>a.product.sell)),m=async(a,r)=>{try{const{data:t}=await n.patch("/user/cart",{product:a,quantity:r});d.cart=t.result,p()}catch(t){console.log(t)}},$=async()=>{var a,r;try{await n.post("/order"),d.cart=0,C.push("/orders")}catch(t){console.log(t),b({text:w("api."+(((r=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(a,r)=>(c(),_(T,null,{default:s(()=>[e(G,null,{default:s(()=>[e(i,{cols:"12"},{default:s(()=>[V("h1",U,l(a.$t("nav.cart")),1)]),_:1}),e(y),e(i,{cols:"12"},{default:s(()=>[e(O,{lines:"two"},{default:s(()=>[(c(!0),k(v,null,z(o.value,(t,L)=>(c(),k(v,{key:t._id},[e(P,{title:t.product.name,subtitle:t.product.price,"active-class":"bg-red",active:!t.product.sell},{prepend:s(()=>[e(D,{rounded:"0"},{default:s(()=>[e(E,{src:t.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[e(u,{color:"red",icon:"mdi-minus",size:"small",class:"me-5",onClick:N=>m(t.product._id,-1)},null,8,["onClick"]),h(" "+l(t.quantity)+" ",1),e(u,{color:"info",icon:"mdi-plus",size:"small",class:"ms-5",onClick:N=>m(t.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),L<o.value.length-1?(c(),_(y,{key:0})):j("",!0)],64))),128))]),_:1})]),_:1}),e(i,{cols:"12",class:"text-center"},{default:s(()=>[V("p",null,l(x.value),1),e(u,{color:"primary",disabled:!B.value,onClick:$},{default:s(()=>[h(l(a.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof g=="function"&&g(W);export{W as default};
